%Funciones de forma lagrangianas del elemento rectangular de 25 nodos:
Nforma=@(xi,eta)[(eta*xi*(- 4*eta^3 + 4*eta^2 + eta - 1)*(- 4*xi^3 + 4*xi^2 + xi - 1))/36;
                 -(2*eta*xi*(- 4*eta^3 + 4*eta^2 + eta - 1)*(- 2*xi^3 + xi^2 + 2*xi - 1))/9;
                 -(eta*(4*xi^4 - 5*xi^2 + 1)*(- 4*eta^3 + 4*eta^2 + eta - 1))/6;
                 -(2*eta*xi*(- 4*eta^3 + 4*eta^2 + eta - 1)*(- 2*xi^3 - xi^2 + 2*xi + 1))/9;
                 (eta*xi*(- 4*eta^3 + 4*eta^2 + eta - 1)*(- 4*xi^3 - 4*xi^2 + xi + 1))/36;
                 -(2*eta*xi*(- 2*eta^3 + eta^2 + 2*eta - 1)*(- 4*xi^3 - 4*xi^2 + xi + 1))/9;
                 -(xi*(4*eta^4 - 5*eta^2 + 1)*(- 4*xi^3 - 4*xi^2 + xi + 1))/6;
                 -(2*eta*xi*(- 4*xi^3 - 4*xi^2 + xi + 1)*(- 2*eta^3 - eta^2 + 2*eta + 1))/9;
                (eta*xi*(- 4*eta^3 - 4*eta^2 + eta + 1)*(- 4*xi^3 - 4*xi^2 + xi + 1))/36;
                 -(2*eta*xi*(- 4*eta^3 - 4*eta^2 + eta + 1)*(- 2*xi^3 - xi^2 + 2*xi + 1))/9;
                 -(eta*(4*xi^4 - 5*xi^2 + 1)*(- 4*eta^3 - 4*eta^2 + eta + 1))/6;
                 -(2*eta*xi*(- 4*eta^3 - 4*eta^2 + eta + 1)*(- 2*xi^3 + xi^2 + 2*xi - 1))/9;
                 (eta*xi*(- 4*eta^3 - 4*eta^2 + eta + 1)*(- 4*xi^3 + 4*xi^2 + xi - 1))/36;
                 -(2*eta*xi*(- 4*xi^3 + 4*xi^2 + xi - 1)*(- 2*eta^3 - eta^2 + 2*eta + 1))/9;
                 -(xi*(4*eta^4 - 5*eta^2 + 1)*(- 4*xi^3 + 4*xi^2 + xi - 1))/6;
                 -(2*eta*xi*(- 2*eta^3 + eta^2 + 2*eta - 1)*(- 4*xi^3 + 4*xi^2 + xi - 1))/9;
                 (16*eta*xi*(- 2*eta^3 + eta^2 + 2*eta - 1)*(- 2*xi^3 + xi^2 + 2*xi - 1))/9;
                 (4*eta*(4*xi^4 - 5*xi^2 + 1)*(- 2*eta^3 + eta^2 + 2*eta - 1))/3;
                 (16*eta*xi*(- 2*eta^3 + eta^2 + 2*eta - 1)*(- 2*xi^3 - xi^2 + 2*xi + 1))/9;
                 (4*xi*(4*eta^4 - 5*eta^2 + 1)*(- 2*xi^3 - xi^2 + 2*xi + 1))/3;
                 (16*eta*xi*(- 2*eta^3 - eta^2 + 2*eta + 1)*(- 2*xi^3 - xi^2 + 2*xi + 1))/9;
                 (4*eta*(4*xi^4 - 5*xi^2 + 1)*(- 2*eta^3 - eta^2 + 2*eta + 1))/3;
                 (16*eta*xi*(- 2*xi^3 + xi^2 + 2*xi - 1)*(- 2*eta^3 - eta^2 + 2*eta + 1))/9;
                 (4*xi*(4*eta^4 - 5*eta^2 + 1)*(- 2*xi^3 + xi^2 + 2*xi - 1))/3;
                 (4*eta^4 - 5*eta^2 + 1)*(4*xi^4 - 5*xi^2 + 1)];

%Funciones de forma lagrangianas del elemento rectangular unidimesioanles de 16 nodos:
NN = @(xi) [-(xi*(- 4*xi^3 + 4*xi^2 + xi - 1))/6;
           (4*xi*(- 2*xi^3 + xi^2 + 2*xi - 1))/3;
            4*xi^4 - 5*xi^2 + 1;
            (4*xi*(- 2*xi^3 - xi^2 + 2*xi + 1))/3;
            -(xi*(- 4*xi^3 - 4*xi^2 + xi + 1))/6];
        
%Derivadas con respecto a xi:
dN_dxi=@(xi,eta)[(eta*(- 4*eta^3 + 4*eta^2 + eta - 1)*(- 16*xi^3 + 12*xi^2 + 2*xi - 1))/36;
                -(2*eta*(- 4*eta^3 + 4*eta^2 + eta - 1)*(- 8*xi^3 + 3*xi^2 + 4*xi - 1))/9;
                (eta*(- 16*xi^3 + 10*xi)*(- 4*eta^3 + 4*eta^2 + eta - 1))/6;
                -(2*eta*(- 4*eta^3 + 4*eta^2 + eta - 1)*(- 8*xi^3 - 3*xi^2 + 4*xi + 1))/9;
                (eta*(- 4*eta^3 + 4*eta^2 + eta - 1)*(- 16*xi^3 - 12*xi^2 + 2*xi + 1))/36;
                -(2*eta*(- 2*eta^3 + eta^2 + 2*eta - 1)*(- 16*xi^3 - 12*xi^2 + 2*xi + 1))/9;
                -((4*eta^4 - 5*eta^2 + 1)*(- 16*xi^3 - 12*xi^2 + 2*xi + 1))/6;
                -(2*eta*(- 2*eta^3 - eta^2 + 2*eta + 1)*(- 16*xi^3 - 12*xi^2 + 2*xi + 1))/9;
                (eta*(- 4*eta^3 - 4*eta^2 + eta + 1)*(- 16*xi^3 - 12*xi^2 + 2*xi + 1))/36;
                -(2*eta*(- 4*eta^3 - 4*eta^2 + eta + 1)*(- 8*xi^3 - 3*xi^2 + 4*xi + 1))/9;
                (eta*(- 16*xi^3 + 10*xi)*(- 4*eta^3 - 4*eta^2 + eta + 1))/6;
                -(2*eta*(- 4*eta^3 - 4*eta^2 + eta + 1)*(- 8*xi^3 + 3*xi^2 + 4*xi - 1))/9;
                (eta*(- 4*eta^3 - 4*eta^2 + eta + 1)*(- 16*xi^3 + 12*xi^2 + 2*xi - 1))/36;
                -(2*eta*(- 2*eta^3 - eta^2 + 2*eta + 1)*(- 16*xi^3 + 12*xi^2 + 2*xi - 1))/9;
                -((4*eta^4 - 5*eta^2 + 1)*(- 16*xi^3 + 12*xi^2 + 2*xi - 1))/6;
                -(2*eta*(- 2*eta^3 + eta^2 + 2*eta - 1)*(- 16*xi^3 + 12*xi^2 + 2*xi - 1))/9;
                (16*eta*(- 2*eta^3 + eta^2 + 2*eta - 1)*(- 8*xi^3 + 3*xi^2 + 4*xi - 1))/9;
                -(4*eta*(- 16*xi^3 + 10*xi)*(- 2*eta^3 + eta^2 + 2*eta - 1))/3;
                (16*eta*(- 2*eta^3 + eta^2 + 2*eta - 1)*(- 8*xi^3 - 3*xi^2 + 4*xi + 1))/9;
                (4*(4*eta^4 - 5*eta^2 + 1)*(- 8*xi^3 - 3*xi^2 + 4*xi + 1))/3;
                (16*eta*(- 2*eta^3 - eta^2 + 2*eta + 1)*(- 8*xi^3 - 3*xi^2 + 4*xi + 1))/9;
                -(4*eta*(- 16*xi^3 + 10*xi)*(- 2*eta^3 - eta^2 + 2*eta + 1))/3;
                (16*eta*(- 2*eta^3 - eta^2 + 2*eta + 1)*(- 8*xi^3 + 3*xi^2 + 4*xi - 1))/9;
                (4*(4*eta^4 - 5*eta^2 + 1)*(- 8*xi^3 + 3*xi^2 + 4*xi - 1))/3;
                -(- 16*xi^3 + 10*xi)*(4*eta^4 - 5*eta^2 + 1)];
 
%funciones unidimesionales Derivadas con respecto a xi:
dNN_dxi = @(xi)[(8*xi^3)/3 - 2*xi^2 - xi/3 + 1/6;
                - (32*xi^3)/3 + 4*xi^2 + (16*xi)/3 - 4/3;
                16*xi^3 - 10*xi;
                - (32*xi^3)/3 - 4*xi^2 + (16*xi)/3 + 4/3;
                (8*xi^3)/3 + 2*xi^2 - xi/3 - 1/6];
 
%Derivadas con respecto a eta:
dN_deta=@(xi,eta)[(xi*(- 4*xi^3 + 4*xi^2 + xi - 1)*(- 16*eta^3 + 12*eta^2 + 2*eta - 1))/36;
                   -(2*xi*(- 2*xi^3 + xi^2 + 2*xi - 1)*(- 16*eta^3 + 12*eta^2 + 2*eta - 1))/9
                   -((4*xi^4 - 5*xi^2 + 1)*(- 16*eta^3 + 12*eta^2 + 2*eta - 1))/6;
                   -(2*xi*(- 16*eta^3 + 12*eta^2 + 2*eta - 1)*(- 2*xi^3 - xi^2 + 2*xi + 1))/9;
                   (xi*(- 4*xi^3 - 4*xi^2 + xi + 1)*(- 16*eta^3 + 12*eta^2 + 2*eta - 1))/36;
                   -(2*xi*(- 4*xi^3 - 4*xi^2 + xi + 1)*(- 8*eta^3 + 3*eta^2 + 4*eta - 1))/9;
                   (xi*(- 16*eta^3 + 10*eta)*(- 4*xi^3 - 4*xi^2 + xi + 1))/6;
                   -(2*xi*(- 4*xi^3 - 4*xi^2 + xi + 1)*(- 8*eta^3 - 3*eta^2 + 4*eta + 1))/9;
                   (xi*(- 4*xi^3 - 4*xi^2 + xi + 1)*(- 16*eta^3 - 12*eta^2 + 2*eta + 1))/36;
                   -(2*xi*(- 16*eta^3 - 12*eta^2 + 2*eta + 1)*(- 2*xi^3 - xi^2 + 2*xi + 1))/9;
                   -((4*xi^4 - 5*xi^2 + 1)*(- 16*eta^3 - 12*eta^2 + 2*eta + 1))/6;
                   -(2*xi*(- 2*xi^3 + xi^2 + 2*xi - 1)*(- 16*eta^3 - 12*eta^2 + 2*eta + 1))/9;
                   (xi*(- 4*xi^3 + 4*xi^2 + xi - 1)*(- 16*eta^3 - 12*eta^2 + 2*eta + 1))/36;
                   -(2*xi*(- 4*xi^3 + 4*xi^2 + xi - 1)*(- 8*eta^3 - 3*eta^2 + 4*eta + 1))/9;
                   (xi*(- 16*eta^3 + 10*eta)*(- 4*xi^3 + 4*xi^2 + xi - 1))/6;
                   -(2*xi*(- 4*xi^3 + 4*xi^2 + xi - 1)*(- 8*eta^3 + 3*eta^2 + 4*eta - 1))/9;
                   (16*xi*(- 2*xi^3 + xi^2 + 2*xi - 1)*(- 8*eta^3 + 3*eta^2 + 4*eta - 1))/9;
                   (4*(4*xi^4 - 5*xi^2 + 1)*(- 8*eta^3 + 3*eta^2 + 4*eta - 1))/3;
                   (16*xi*(- 8*eta^3 + 3*eta^2 + 4*eta - 1)*(- 2*xi^3 - xi^2 + 2*xi + 1))/9;
                   -(4*xi*(- 16*eta^3 + 10*eta)*(- 2*xi^3 - xi^2 + 2*xi + 1))/3;
                   (16*xi*(- 8*eta^3 - 3*eta^2 + 4*eta + 1)*(- 2*xi^3 - xi^2 + 2*xi + 1))/9;
                   (4*(4*xi^4 - 5*xi^2 + 1)*(- 8*eta^3 - 3*eta^2 + 4*eta + 1))/3;
                   (16*xi*(- 2*xi^3 + xi^2 + 2*xi - 1)*(- 8*eta^3 - 3*eta^2 + 4*eta + 1))/9;
                   -(4*xi*(- 16*eta^3 + 10*eta)*(- 2*xi^3 + xi^2 + 2*xi - 1))/3;
                   -(- 16*eta^3 + 10*eta)*(4*xi^4 - 5*xi^2 + 1)];
               
%La matriz de interpolacion del EF lagrangiano rectangular de 25 nodos es:
A = [[       3^(1/2)/2 + 1,                -1/2,                -1/2,       1 - 3^(1/2)/2];
    [ (3*3^(1/2))/8 + 5/8,   - 3^(1/2)/8 - 1/8,     3^(1/2)/8 - 1/8, 5/8 - (3*3^(1/2))/8];
    [     3^(1/2)/4 + 1/4,     1/4 - 3^(1/2)/4,     3^(1/2)/4 + 1/4,     1/4 - 3^(1/2)/4];
    [     3^(1/2)/8 - 1/8, 5/8 - (3*3^(1/2))/8, (3*3^(1/2))/8 + 5/8,   - 3^(1/2)/8 - 1/8];
    [                -1/2,       1 - 3^(1/2)/2,       3^(1/2)/2 + 1,                -1/2];
    [   - 3^(1/2)/8 - 1/8, 5/8 - (3*3^(1/2))/8, (3*3^(1/2))/8 + 5/8,     3^(1/2)/8 - 1/8];
    [     1/4 - 3^(1/2)/4,     1/4 - 3^(1/2)/4,     3^(1/2)/4 + 1/4,     3^(1/2)/4 + 1/4];
    [ 5/8 - (3*3^(1/2))/8,   - 3^(1/2)/8 - 1/8,     3^(1/2)/8 - 1/8, (3*3^(1/2))/8 + 5/8];
    [       1 - 3^(1/2)/2,                -1/2,                -1/2,       3^(1/2)/2 + 1];
    [ 5/8 - (3*3^(1/2))/8,     3^(1/2)/8 - 1/8,   - 3^(1/2)/8 - 1/8, (3*3^(1/2))/8 + 5/8];
    [     1/4 - 3^(1/2)/4,     3^(1/2)/4 + 1/4,     1/4 - 3^(1/2)/4,     3^(1/2)/4 + 1/4];
    [   - 3^(1/2)/8 - 1/8, (3*3^(1/2))/8 + 5/8, 5/8 - (3*3^(1/2))/8,     3^(1/2)/8 - 1/8];
    [                -1/2,       3^(1/2)/2 + 1,       1 - 3^(1/2)/2,                -1/2];
    [     3^(1/2)/8 - 1/8, (3*3^(1/2))/8 + 5/8, 5/8 - (3*3^(1/2))/8,   - 3^(1/2)/8 - 1/8];
    [     3^(1/2)/4 + 1/4,     3^(1/2)/4 + 1/4,     1/4 - 3^(1/2)/4,     1/4 - 3^(1/2)/4];
    [ (3*3^(1/2))/8 + 5/8,     3^(1/2)/8 - 1/8,   - 3^(1/2)/8 - 1/8, 5/8 - (3*3^(1/2))/8];
    [    3^(1/2)/4 + 7/16,                1/16,                1/16,    7/16 - 3^(1/2)/4];
    [     3^(1/2)/8 + 1/4,     1/4 - 3^(1/2)/8,     3^(1/2)/8 + 1/4,     1/4 - 3^(1/2)/8];
    [                1/16,    7/16 - 3^(1/2)/4,    3^(1/2)/4 + 7/16,                1/16];
    [     1/4 - 3^(1/2)/8,     1/4 - 3^(1/2)/8,     3^(1/2)/8 + 1/4,     3^(1/2)/8 + 1/4];
    [    7/16 - 3^(1/2)/4,                1/16,                1/16,    3^(1/2)/4 + 7/16];
    [     1/4 - 3^(1/2)/8,     3^(1/2)/8 + 1/4,     1/4 - 3^(1/2)/8,     3^(1/2)/8 + 1/4];
    [                1/16,    3^(1/2)/4 + 7/16,    7/16 - 3^(1/2)/4,                1/16];
    [     3^(1/2)/8 + 1/4,     3^(1/2)/8 + 1/4,     1/4 - 3^(1/2)/8,     1/4 - 3^(1/2)/8];
    [                 1/4,                 1/4,                 1/4,                 1/4]];
 