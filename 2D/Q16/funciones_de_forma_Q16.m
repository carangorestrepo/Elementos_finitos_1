Nforma=@(xi,eta)[(- (9*eta^3)/16 + (9*eta^2)/16 + eta/16 - 1/16)*(- (9*xi^3)/16 + (9*xi^2)/16 + xi/16 - 1/16);    %N1
                -(- (9*eta^3)/16 + (9*eta^2)/16 + eta/16 - 1/16)*(- (27*xi^3)/16 + (9*xi^2)/16 + (27*xi)/16 - 9/16);    %N2
                 (- (9*eta^3)/16 + (9*eta^2)/16 + eta/16 - 1/16)*((27*xi)/16 - (9*xi^2)/16 - (27*xi^3)/16 + 9/16);    %N3
                -(- (9*eta^3)/16 + (9*eta^2)/16 + eta/16 - 1/16)*(xi/16 - (9*xi^2)/16 - (9*xi^3)/16 + 1/16);    %N4
                 (- (27*eta^3)/16 + (9*eta^2)/16 + (27*eta)/16 - 9/16)*(xi/16 - (9*xi^2)/16 - (9*xi^3)/16 + 1/16);    %N5
                -((27*eta)/16 - (9*eta^2)/16 - (27*eta^3)/16 + 9/16)*(xi/16 - (9*xi^2)/16 - (9*xi^3)/16 + 1/16);    %N6
                 (eta/16 - (9*eta^2)/16 - (9*eta^3)/16 + 1/16)*(xi/16 - (9*xi^2)/16 - (9*xi^3)/16 + 1/16);    %N7
                -(eta/16 - (9*eta^2)/16 - (9*eta^3)/16 + 1/16)*((27*xi)/16 - (9*xi^2)/16 - (27*xi^3)/16 + 9/16);    %N8
                (eta/16 - (9*eta^2)/16 - (9*eta^3)/16 + 1/16)*(- (27*xi^3)/16 + (9*xi^2)/16 + (27*xi)/16 - 9/16);    %N9
               -(eta/16 - (9*eta^2)/16 - (9*eta^3)/16 + 1/16)*(- (9*xi^3)/16 + (9*xi^2)/16 + xi/16 - 1/16);    %N10
                ((27*eta)/16 - (9*eta^2)/16 - (27*eta^3)/16 + 9/16)*(- (9*xi^3)/16 + (9*xi^2)/16 + xi/16 - 1/16);    %N11
               -(- (27*eta^3)/16 + (9*eta^2)/16 + (27*eta)/16 - 9/16)*(- (9*xi^3)/16 + (9*xi^2)/16 + xi/16 - 1/16);    %N12
                (- (27*eta^3)/16 + (9*eta^2)/16 + (27*eta)/16 - 9/16)*(- (27*xi^3)/16 + (9*xi^2)/16 + (27*xi)/16 - 9/16);    %N13
               -(- (27*eta^3)/16 + (9*eta^2)/16 + (27*eta)/16 - 9/16)*((27*xi)/16 - (9*xi^2)/16 - (27*xi^3)/16 + 9/16);    %N14
                ((27*eta)/16 - (9*eta^2)/16 - (27*eta^3)/16 + 9/16)*((27*xi)/16 - (9*xi^2)/16 - (27*xi^3)/16 + 9/16);    %N15
               -((27*eta)/16 - (9*eta^2)/16 - (27*eta^3)/16 + 9/16)*(- (27*xi^3)/16 + (9*xi^2)/16 + (27*xi)/16 - 9/16)];    %N16
 

%Derivadas con respecto a xi:
dN_dxi=@(xi,eta)[((9*xi)/8 - (27*xi^2)/16 + 1/16)*(- (9*eta^3)/16 + (9*eta^2)/16 + eta/16 - 1/16);
                -((9*xi)/8 - (81*xi^2)/16 + 27/16)*(- (9*eta^3)/16 + (9*eta^2)/16 + eta/16 - 1/16);
                -((81*xi^2)/16 + (9*xi)/8 - 27/16)*(- (9*eta^3)/16 + (9*eta^2)/16 + eta/16 - 1/16);
                ((27*xi^2)/16 + (9*xi)/8 - 1/16)*(- (9*eta^3)/16 + (9*eta^2)/16 + eta/16 - 1/16);
                -((27*xi^2)/16 + (9*xi)/8 - 1/16)*(- (27*eta^3)/16 + (9*eta^2)/16 + (27*eta)/16 - 9/16);
                 ((27*xi^2)/16 + (9*xi)/8 - 1/16)*((27*eta)/16 - (9*eta^2)/16 - (27*eta^3)/16 + 9/16);
                -((27*xi^2)/16 + (9*xi)/8 - 1/16)*(eta/16 - (9*eta^2)/16 - (9*eta^3)/16 + 1/16);
                 ((81*xi^2)/16 + (9*xi)/8 - 27/16)*(eta/16 - (9*eta^2)/16 - (9*eta^3)/16 + 1/16);
                 ((9*xi)/8 - (81*xi^2)/16 + 27/16)*(eta/16 - (9*eta^2)/16 - (9*eta^3)/16 + 1/16);
                -((9*xi)/8 - (27*xi^2)/16 + 1/16)*(eta/16 - (9*eta^2)/16 - (9*eta^3)/16 + 1/16);
                 ((9*xi)/8 - (27*xi^2)/16 + 1/16)*((27*eta)/16 - (9*eta^2)/16 - (27*eta^3)/16 + 9/16);
                -((9*xi)/8 - (27*xi^2)/16 + 1/16)*(- (27*eta^3)/16 + (9*eta^2)/16 + (27*eta)/16 - 9/16);
                 ((9*xi)/8 - (81*xi^2)/16 + 27/16)*(- (27*eta^3)/16 + (9*eta^2)/16 + (27*eta)/16 - 9/16);
                 ((81*xi^2)/16 + (9*xi)/8 - 27/16)*(- (27*eta^3)/16 + (9*eta^2)/16 + (27*eta)/16 - 9/16);
                -((81*xi^2)/16 + (9*xi)/8 - 27/16)*((27*eta)/16 - (9*eta^2)/16 - (27*eta^3)/16 + 9/16);
                 -((9*xi)/8 - (81*xi^2)/16 + 27/16)*((27*eta)/16 - (9*eta^2)/16 - (27*eta^3)/16 + 9/16)];
 
%Derivadas con respecto a eta:
dN_deta=@(xi,eta)[((9*eta)/8 - (27*eta^2)/16 + 1/16)*(- (9*xi^3)/16 + (9*xi^2)/16 + xi/16 - 1/16);
                 -((9*eta)/8 - (27*eta^2)/16 + 1/16)*(- (27*xi^3)/16 + (9*xi^2)/16 + (27*xi)/16 - 9/16);
                 ((9*eta)/8 - (27*eta^2)/16 + 1/16)*((27*xi)/16 - (9*xi^2)/16 - (27*xi^3)/16 + 9/16);
                 -((9*eta)/8 - (27*eta^2)/16 + 1/16)*(xi/16 - (9*xi^2)/16 - (9*xi^3)/16 + 1/16);
                 ((9*eta)/8 - (81*eta^2)/16 + 27/16)*(xi/16 - (9*xi^2)/16 - (9*xi^3)/16 + 1/16);
                 ((81*eta^2)/16 + (9*eta)/8 - 27/16)*(xi/16 - (9*xi^2)/16 - (9*xi^3)/16 + 1/16);
                 -((27*eta^2)/16 + (9*eta)/8 - 1/16)*(xi/16 - (9*xi^2)/16 - (9*xi^3)/16 + 1/16);
                 ((27*eta^2)/16 + (9*eta)/8 - 1/16)*((27*xi)/16 - (9*xi^2)/16 - (27*xi^3)/16 + 9/16);
                 -((27*eta^2)/16 + (9*eta)/8 - 1/16)*(- (27*xi^3)/16 + (9*xi^2)/16 + (27*xi)/16 - 9/16);
                 ((27*eta^2)/16 + (9*eta)/8 - 1/16)*(- (9*xi^3)/16 + (9*xi^2)/16 + xi/16 - 1/16);
                  -((81*eta^2)/16 + (9*eta)/8 - 27/16)*(- (9*xi^3)/16 + (9*xi^2)/16 + xi/16 - 1/16);
                 -((9*eta)/8 - (81*eta^2)/16 + 27/16)*(- (9*xi^3)/16 + (9*xi^2)/16 + xi/16 - 1/16);
                 ((9*eta)/8 - (81*eta^2)/16 + 27/16)*(- (27*xi^3)/16 + (9*xi^2)/16 + (27*xi)/16 - 9/16);
                 -((9*eta)/8 - (81*eta^2)/16 + 27/16)*((27*xi)/16 - (9*xi^2)/16 - (27*xi^3)/16 + 9/16);
                 -((81*eta^2)/16 + (9*eta)/8 - 27/16)*((27*xi)/16 - (9*xi^2)/16 - (27*xi^3)/16 + 9/16);
                 ((81*eta^2)/16 + (9*eta)/8 - 27/16)*(- (27*xi^3)/16 + (9*xi^2)/16 + (27*xi)/16 - 9/16)];
             
%Funciones de forma lagrangianas del elemento rectangular unidimesioanles de 16 nodos:
NN = @(xi) [- (9*xi^3)/16 + (9*xi^2)/16 + xi/16 - 1/16;
           (27*xi^3)/16 - (9*xi^2)/16 - (27*xi)/16 + 9/16;
           (27*xi)/16 - (9*xi^2)/16 - (27*xi^3)/16 + 9/16;
           (9*xi^3)/16 + (9*xi^2)/16 - xi/16 - 1/16];

             
%funciones unidimesionales Derivadas con respecto a xi:
dNN_dxi = @(xi)[(9*xi)/8 - (27*xi^2)/16 + 1/16;
                (81*xi^2)/16 - (9*xi)/8 - 27/16;
                27/16 - (81*xi^2)/16 - (9*xi)/8;
                (27*xi^2)/16 + (9*xi)/8 - 1/16];
%La matriz de interpolacion del EF lagrangiano rectangular de 16 nodos es:
            
A = [[   3^(1/2)/2 + 1,            -1/2,            -1/2,   1 - 3^(1/2)/2];
    [ 3^(1/2)/3 + 1/2,      -3^(1/2)/6,       3^(1/2)/6, 1/2 - 3^(1/2)/3];
    [       3^(1/2)/6, 1/2 - 3^(1/2)/3, 3^(1/2)/3 + 1/2,      -3^(1/2)/6];
    [            -1/2,   1 - 3^(1/2)/2,   3^(1/2)/2 + 1,            -1/2];
    [      -3^(1/2)/6, 1/2 - 3^(1/2)/3, 3^(1/2)/3 + 1/2,       3^(1/2)/6];
    [ 1/2 - 3^(1/2)/3,      -3^(1/2)/6,       3^(1/2)/6, 3^(1/2)/3 + 1/2];
    [   1 - 3^(1/2)/2,            -1/2,            -1/2,   3^(1/2)/2 + 1];
    [ 1/2 - 3^(1/2)/3,       3^(1/2)/6,      -3^(1/2)/6, 3^(1/2)/3 + 1/2];
    [      -3^(1/2)/6, 3^(1/2)/3 + 1/2, 1/2 - 3^(1/2)/3,       3^(1/2)/6];
    [            -1/2,   3^(1/2)/2 + 1,   1 - 3^(1/2)/2,            -1/2];
    [       3^(1/2)/6, 3^(1/2)/3 + 1/2, 1/2 - 3^(1/2)/3,      -3^(1/2)/6];
    [ 3^(1/2)/3 + 1/2,       3^(1/2)/6,      -3^(1/2)/6, 1/2 - 3^(1/2)/3];
    [ 3^(1/2)/6 + 1/3,             1/6,             1/6, 1/3 - 3^(1/2)/6];
    [             1/6, 1/3 - 3^(1/2)/6, 3^(1/2)/6 + 1/3,             1/6];
    [ 1/3 - 3^(1/2)/6,             1/6,             1/6, 3^(1/2)/6 + 1/3];
    [             1/6, 3^(1/2)/6 + 1/3, 1/3 - 3^(1/2)/6,             1/6]];
             
 
