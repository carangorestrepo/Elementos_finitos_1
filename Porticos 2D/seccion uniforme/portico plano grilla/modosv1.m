%pagina 251 LEG
%k=10^3*[76.8690000000000,-99.6910000000000,25.5830000000000,-3.74700000000000;
%       -99.6910000000000,209.140000000000,-136.020000000000,31.1080000000000;
%        25.5830000000000,-136.020000000000,221.760000000000,-142.110000000000;
%       -3.47470000000000,31.1080000000000,-142.110000000000,252.100000000000];
%m=[60,0,0,0;0,60,0,0;0,0,60,0;0,0,0,60];


k=Kdd;%[2787088.89696435,-1393544.44848218,0,0,0;-1393544.44848218,2787088.89696435,-1393544.44848218,0,0;0,-1393544.44848218,2787088.89696435,-1393544.44848218,0;0,0,-1393544.44848218,2787088.89696435,-1393544.44848218;0,0,0,-1393544.44848218,1393544.44848218];

m=Mdd;%[81.2118816609372,0,0,0,0;0,81.2118816609372,0,0,0;0,0,81.2118816609372,0,0;0,0,0,81.2118816609372,0;0,0,0,0,81.2118816609372];
%m=-MMexdd;

%k=[2876240,-1576771,264399,45040,12904;-1576771,2627908,-1621812,248332,65978;264399,-1621812,2611841,-1666852,367384;45040,248332,-1666852,2363509,-998063;12904,65978,367384,-998063,549362];

%m=[162.650000000000,0,0,0,0;0,162.650000000000,0,0,0;0,0,162.650000000000,0,0;0,0,0,162.650000000000,0;0,0,0,0,162.650000000000]

%% Luis enrique garcia pag 288
%k=10^3*[216760,-306770,105490,-19561,4282.20000000000,-510.880000000000;-306770,668240,-475140,137940,-29375,5385.70000000000;105490,-475140,731370,-493230,159600,-29327;-19561,137940,-493230,749020,-494470,145710;4282.20000000000,-29375,159600,-494470,738110,-511900;-510.880000000000,5385.70000000000,-29327,145710,-511900,889940];
%m=[256,0,0,0,0,0;0,256,0,0,0,0;0,0,256,0,0,0;0,0,0,256,0,0;0,0,0,0,256,0;0,0,0,0,0,256];
%sizexy(1,1)=5;
%GL=1;
%k=[742329,0,0,-23186,0,-46372,0,0,0,-695956,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,3111317,10926,0,-1553474,0,0,0,0,0,-4370,10926,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,10926,286811,46372,0,60381,0,0,0,0,-10926,18034,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;-23186,0,46372,742329,0,0,-23186,0,-46372,0,0,0,-695956,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,-1553474,0,0,3111317,10926,0,-1553474,0,0,0,0,0,-4370,10926,0,0,0,0,0,0,0,0,0,0,0,0;-46372,0,60381,0,10926,286811,46372,0,60381,0,0,0,0,-10926,18034,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,-23186,0,46372,719142,0,46372,0,0,0,0,0,0,-695956,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,-1553474,0,0,1557844,10926,0,0,0,0,0,0,0,-4370,10926,0,0,0,0,0,0,0,0,0;0,0,0,-46372,0,60381,46372,10926,161702,0,0,0,0,0,0,0,-10926,18034,0,0,0,0,0,0,0,0,0;-695956,0,0,0,0,0,0,0,0,1438285,0,0,-23186,0,-46372,0,0,0,-695956,0,0,0,0,0,0,0,0;0,-4370,-10926,0,0,0,0,0,0,0,3115688,0,0,-1553474,0,0,0,0,0,-4370,10926,0,0,0,0,0,0;0,10926,18034,0,0,0,0,0,0,0,0,323404,46372,0,60381,0,0,0,0,-10926,18034,0,0,0,0,0,0;0,0,0,-695956,0,0,0,0,0,-23186,0,46372,1438285,0,0,-23186,0,-46372,0,0,0,-695956,0,0,0,0,0;0,0,0,0,-4370,-10926,0,0,0,0,-1553474,0,0,3115688,0,0,-1553474,0,0,0,0,0,-4370,10926,0,0,0;0,0,0,0,10926,18034,0,0,0,-46372,0,60381,0,0,323404,46372,0,60381,0,0,0,0,-10926,18034,0,0,0;0,0,0,0,0,0,-695956,0,0,0,0,0,-23186,0,46372,1415099,0,46372,0,0,0,0,0,0,-695956,0,0;0,0,0,0,0,0,0,-4370,-10926,0,0,0,0,-1553474,0,0,1562214,0,0,0,0,0,0,0,0,-4370,10926;0,0,0,0,0,0,0,10926,18034,0,0,0,-46372,0,60381,46372,0,198295,0,0,0,0,0,0,0,-10926,18034;0,0,0,0,0,0,0,0,0,-695956,0,0,0,0,0,0,0,0,742329,0,0,-23186,0,-46372,0,0,0;0,0,0,0,0,0,0,0,0,0,-4370,-10926,0,0,0,0,0,0,0,3111317,-10926,0,-1553474,0,0,0,0;0,0,0,0,0,0,0,0,0,0,10926,18034,0,0,0,0,0,0,0,-10926,286811,46372,0,60381,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,-695956,0,0,0,0,0,-23186,0,46372,742329,0,0,-23186,0,-46372;0,0,0,0,0,0,0,0,0,0,0,0,0,-4370,-10926,0,0,0,0,-1553474,0,0,3111317,-10926,0,-1553474,0;0,0,0,0,0,0,0,0,0,0,0,0,0,10926,18034,0,0,0,-46372,0,60381,0,-10926,286811,46372,0,60381;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-695956,0,0,0,0,0,-23186,0,46372,719142,0,46372;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-4370,-10926,0,0,0,0,-1553474,0,0,1557844,-10926;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,10926,18034,0,0,0,-46372,0,60381,46372,-10926,161702];
%m=[53.9870500000000,0,0,3.13147000000000,0,3.02724000000000,0,0,0,18.1250000000000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,56.3052900000000,28.3484800000000,0,4,0,0,0,0,0,14.0697100000000,-16.9640200000000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,28.3484800000000,33.0067100000000,-3.02724000000000,0,-2.78284000000000,0,0,0,0,16.9640200000000,-19.5404000000000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;3.13147000000000,0,-3.02724000000000,53.9870500000000,0,0,3.13147000000000,0,3.02724000000000,0,0,0,18.1250000000000,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,4,0,0,56.3052900000000,28.3484800000000,0,4,0,0,0,0,0,14.0697100000000,-16.9640200000000,0,0,0,0,0,0,0,0,0,0,0,0;3.02724000000000,0,-2.78284000000000,0,28.3484800000000,33.0067100000000,-3.02724000000000,0,-2.78284000000000,0,0,0,0,16.9640200000000,-19.5404000000000,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,3.13147000000000,0,-3.02724000000000,34.3185300000000,0,4.97276000000000,0,0,0,0,0,0,12.7250000000000,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,4,0,0,36.2971000000000,19.9025900000000,0,0,0,0,0,0,0,9.87790000000000,-11.9099100000000,0,0,0,0,0,0,0,0,0;0,0,0,3.02724000000000,0,-2.78284000000000,4.97276000000000,19.9025900000000,21.7111200000000,0,0,0,0,0,0,0,11.9099100000000,-13.7187100000000,0,0,0,0,0,0,0,0,0;18.1250000000000,0,0,0,0,0,0,0,0,90.2370500000000,0,0,3.13147000000000,0,3.02724000000000,0,0,0,18.1250000000000,0,0,0,0,0,0,0,0;0,14.0697100000000,16.9640200000000,0,0,0,0,0,0,0,96.6105900000000,0,0,4,0,0,0,0,0,14.0697100000000,-16.9640200000000,0,0,0,0,0,0;0,-16.9640200000000,-19.5404000000000,0,0,0,0,0,0,0,0,58.7789200000000,-3.02724000000000,0,-2.78284000000000,0,0,0,0,16.9640200000000,-19.5404000000000,0,0,0,0,0,0;0,0,0,18.1250000000000,0,0,0,0,0,3.13147000000000,0,5.84128000000000,81.3685300000000,-4.97276000000000,8.10423000000000,0,3.02724000000000,0,0,0,0,18.1250000000000,0,0,0,0,0;0,0,0,0,14.0697100000000,16.9640200000000,0,0,0,0,4,0,8,88.6105900000000,0,4,0,0,0,0,0,0,14.0697100000000,-16.9640200000000,0,0,0;0,0,0,0,-16.9640200000000,-19.5404000000000,0,0,0,3.02724000000000,0,-7.75560000000000,4.97276000000000,3.61725000000000,52.1344300000000,0,-2.78284000000000,0,0,0,0,0,16.9640200000000,-19.5404000000000,0,0,0;0,0,0,0,0,0,12.7250000000000,0,0,0,0,3.13147000000000,0,-3.02724000000000,8.86853000000000,50.9000000000000,4.97276000000000,0,0,0,0,0,0,0,12.7250000000000,0,0;0,0,0,0,0,0,0,9.87790000000000,11.9099100000000,0,0,0,4,0,0,8,56.5941900000000,0,0,0,0,0,0,0,0,9.87790000000000,-11.9099100000000;0,0,0,0,0,0,0,-11.9099100000000,-13.7187100000000,0,0,3.02724000000000,0,-2.78284000000000,4.97276000000000,0,3.61725000000000,36.1877400000000,0,0,0,0,0,0,0,11.9099100000000,-13.7187100000000;0,0,0,0,0,0,0,0,0,18.1250000000000,0,0,0,0,0,0,0,0,53.9870500000000,0,0,3.13147000000000,0,3.02724000000000,0,0,0;0,0,0,0,0,0,0,0,0,0,14.0697100000000,16.9640200000000,0,0,0,0,0,0,0,56.3052900000000,-28.3484800000000,0,4,0,0,0,0;0,0,0,0,0,0,0,0,0,0,-16.9640200000000,-19.5404000000000,0,0,0,0,0,0,0,-28.3484800000000,33.0067100000000,-3.02724000000000,0,-2.78284000000000,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,18.1250000000000,0,0,0,0,0,3.13147000000000,0,-3.02724000000000,53.9870500000000,0,0,3.13147000000000,0,3.02724000000000;0,0,0,0,0,0,0,0,0,0,0,0,0,14.0697100000000,16.9640200000000,0,0,0,0,4,0,0,56.3052900000000,-28.3484800000000,0,4,0;0,0,0,0,0,0,0,0,0,0,0,0,0,-16.9640200000000,-19.5404000000000,0,0,0,3.02724000000000,0,-2.78284000000000,0,-28.3484800000000,33.0067100000000,-3.02724000000000,0,-2.78284000000000;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12.7250000000000,0,0,0,0,0,3.13147000000000,0,-3.02724000000000,34.3185300000000,0,4.97276000000000;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9.87790000000000,11.9099100000000,0,0,0,0,4,0,0,36.2971000000000,-19.9025900000000;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-11.9099100000000,-13.7187100000000,0,0,0,3.02724000000000,0,-2.78284000000000,4.97276000000000,-19.9025900000000,21.7111200000000];

%% Datos de ejerccio 7.5 jorge eduardo hurtado

%k=[263566.776400000,-134299.166700000,33204.2365400000,-4754.10071200000,501.902652000000;-134299.166700000,158871.567100000,-87647.8376900000,19177.7908300000,-2024.64875200000;33204.2365400000,-87647.8376900000,110674.390300000,-58017.0217400000,9331.77330800000;-4754.10071200000,19177.7908300000,-58017.0217400000,73230.6198400000,-30717.6401300000;501.902652000000,-2024.64875200000,9331.77330800000,-30717.6401300000,23022.6684600000];
%m=[60,0,0,0,0;0,60,0,0,0;0,0,60,0,0;0,0,0,60,0;0,0,0,0,60];
%k=k*4;
%GL=1;
%%val=ones(n,1);
%%
%k=[963782.407407407,0,42326.3888888888,-67782.4074074074,0,-101673.611111111,0,0,0,0,0,0,0,0,0,-800000,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,4424666.66666667,20000,0,-2016666.66666667,0,0,0,0,0,0,0,0,0,0,0,-8000,20000,0,0,0,0,0,0,0,0,0,0,0,0;42326.3888888888,20000,558013.888888889,101673.611111111,0,101673.611111111,0,0,0,0,0,0,0,0,0,0,-20000,33333.3333333333,0,0,0,0,0,0,0,0,0,0,0,0;-67782.4074074074,0,101673.611111111,914078.703703704,0,32229.1666666667,-46296.2962962963,0,-69444.4444444444,0,0,0,0,0,0,0,0,0,-800000,0,0,0,0,0,0,0,0,0,0,0;0,-2016666.66666667,0,0,3691333.33333333,20000,0,-1666666.66666667,0,0,0,0,0,0,0,0,0,0,0,-8000,20000,0,0,0,0,0,0,0,0,0;-101673.611111111,0,101673.611111111,32229.1666666667,20000,408902.777777778,69444.4444444444,0,69444.4444444444,0,0,0,0,0,0,0,0,0,0,-20000,33333.3333333333,0,0,0,0,0,0,0,0,0;0,0,0,-46296.2962962963,0,69444.4444444444,876671.296296296,0,23881.9444444444,-30375,0,-45562.5000000000,0,0,0,0,0,0,0,0,0,-800000,0,0,0,0,0,0,0,0;0,0,0,0,-1666666.66666667,0,0,3024666.66666667,20000,0,-1350000,0,0,0,0,0,0,0,0,0,0,0,-8000,20000,0,0,0,0,0,0;0,0,0,-69444.4444444444,0,69444.4444444444,23881.9444444444,20000,296680.555555556,45562.5000000000,0,45562.5000000000,0,0,0,0,0,0,0,0,0,0,-20000,33333.3333333333,0,0,0,0,0,0;0,0,0,0,0,0,-30375,0,45562.5000000000,849337.962962963,0,17118.0555555556,-18962.9629629630,0,-28444.4444444445,0,0,0,0,0,0,0,0,0,-800000,0,0,0,0,0;0,0,0,0,0,0,0,-1350000,0,0,2424666.66666667,20000,0,-1066666.66666667,0,0,0,0,0,0,0,0,0,0,0,-8000,20000,0,0,0;0,0,0,0,0,0,-45562.5000000000,0,45562.5000000000,17118.0555555556,20000,214680.555555556,28444.4444444445,0,28444.4444444445,0,0,0,0,0,0,0,0,0,0,-20000,33333.3333333333,0,0,0;0,0,0,0,0,0,0,0,0,-18962.9629629630,0,28444.4444444445,818962.962962963,0,28444.4444444445,0,0,0,0,0,0,0,0,0,0,0,0,-800000,0,0;0,0,0,0,0,0,0,0,0,0,-1066666.66666667,0,0,1074666.66666667,20000,0,0,0,0,0,0,0,0,0,0,0,0,0,-8000,20000;0,0,0,0,0,0,0,0,0,-28444.4444444445,0,28444.4444444445,28444.4444444445,20000,123555.555555556,0,0,0,0,0,0,0,0,0,0,0,0,0,-20000,33333.3333333333;-800000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,963782.407407407,0,42326.3888888888,-67782.4074074074,0,-101673.611111111,0,0,0,0,0,0,0,0,0;0,-8000,-20000,0,0,0,0,0,0,0,0,0,0,0,0,0,4424666.66666667,-20000,0,-2016666.66666667,0,0,0,0,0,0,0,0,0,0;0,20000,33333.3333333333,0,0,0,0,0,0,0,0,0,0,0,0,42326.3888888888,-20000,558013.888888889,101673.611111111,0,101673.611111111,0,0,0,0,0,0,0,0,0;0,0,0,-800000,0,0,0,0,0,0,0,0,0,0,0,-67782.4074074074,0,101673.611111111,914078.703703704,0,32229.1666666667,-46296.2962962963,0,-69444.4444444444,0,0,0,0,0,0;0,0,0,0,-8000,-20000,0,0,0,0,0,0,0,0,0,0,-2016666.66666667,0,0,3691333.33333333,-20000,0,-1666666.66666667,0,0,0,0,0,0,0;0,0,0,0,20000,33333.3333333333,0,0,0,0,0,0,0,0,0,-101673.611111111,0,101673.611111111,32229.1666666667,-20000,408902.777777778,69444.4444444444,0,69444.4444444444,0,0,0,0,0,0;0,0,0,0,0,0,-800000,0,0,0,0,0,0,0,0,0,0,0,-46296.2962962963,0,69444.4444444444,876671.296296296,0,23881.9444444444,-30375,0,-45562.5000000000,0,0,0;0,0,0,0,0,0,0,-8000,-20000,0,0,0,0,0,0,0,0,0,0,-1666666.66666667,0,0,3024666.66666667,-20000,0,-1350000,0,0,0,0;0,0,0,0,0,0,0,20000,33333.3333333333,0,0,0,0,0,0,0,0,0,-69444.4444444444,0,69444.4444444444,23881.9444444444,-20000,296680.555555556,45562.5000000000,0,45562.5000000000,0,0,0;0,0,0,0,0,0,0,0,0,-800000,0,0,0,0,0,0,0,0,0,0,0,-30375,0,45562.5000000000,849337.962962963,0,17118.0555555556,-18962.9629629630,0,-28444.4444444445;0,0,0,0,0,0,0,0,0,0,-8000,-20000,0,0,0,0,0,0,0,0,0,0,-1350000,0,0,2424666.66666667,-20000,0,-1066666.66666667,0;0,0,0,0,0,0,0,0,0,0,20000,33333.3333333333,0,0,0,0,0,0,0,0,0,-45562.5000000000,0,45562.5000000000,17118.0555555556,-20000,214680.555555556,28444.4444444445,0,28444.4444444445;0,0,0,0,0,0,0,0,0,0,0,0,-800000,0,0,0,0,0,0,0,0,0,0,0,-18962.9629629630,0,28444.4444444445,818962.962962963,0,28444.4444444445;0,0,0,0,0,0,0,0,0,0,0,0,0,-8000,-20000,0,0,0,0,0,0,0,0,0,0,-1066666.66666667,0,0,1074666.66666667,-20000;0,0,0,0,0,0,0,0,0,0,0,0,0,20000,33333.3333333333,0,0,0,0,0,0,0,0,0,-28444.4444444445,0,28444.4444444445,28444.4444444445,-20000,123555.555555556];
%m=[30,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,30,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,30,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,30,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,30,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,30,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];
%pendulo envietido
%k=[9708.73786407767,0,19417.4757281553;0,1000000,0;19417.4757281553,0,52168.2847896440];
%m=[200,0,0;0,200,0;0,0,0]*1/9.8066502;

%k=[69300,-35700,0;-35700,58200,-22500;0,-22500,22500];

%m=[75,0,0;0,75,0;0,0,50];
%% matriz sotware
%k=kmodal; %%% kN
%m=mmodal/9.806;%%% ton
GL=3;
n=12;%% modos 
%% matriz de excel
%m=[78.3750000000000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,78.3750000000000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,78.3750000000000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,78.3750000000000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,50.1750000000000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,50.1750000000000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,132.750000000000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,132.750000000000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,132.750000000000,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,132.750000000000,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,88.3500000000000,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,88.3500000000000,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,78.3750000000000,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,78.3750000000000,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,78.3750000000000,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,78.3750000000000,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,50.1750000000000,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,50.1750000000000,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];
%k=[742761.115100000,0,0,-23199.6850000000,0,-46399.3700000000,0,0,0,-696361.745100000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,3113130.54870000,10931.8955000000,0,-1554378.89530000,0,0,0,0,0,-4372.75820000000,10931.8955000000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,10931.8955000000,286977.829400000,46399.3700000000,0,60415.8464000000,0,0,0,0,-10931.8955000000,18044.9155000000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;-23199.6850000000,0,46399.3700000000,742761.115100000,0,0,-23199.6850000000,0,-46399.3700000000,0,0,0,-696361.745100000,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,-1554378.89530000,0,0,3113130.54870000,10931.8955000000,0,-1554378.89530000,0,0,0,0,0,-4372.75820000000,10931.8955000000,0,0,0,0,0,0,0,0,0,0,0,0;-46399.3700000000,0,60415.8464000000,0,10931.8955000000,286977.829400000,46399.3700000000,0,60415.8464000000,0,0,0,0,-10931.8955000000,18044.9155000000,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,-23199.6850000000,0,46399.3700000000,719561.430100000,0,46399.3700000000,0,0,0,0,0,0,-696361.745100000,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,-1554378.89530000,0,0,1558751.65350000,10931.8955000000,0,0,0,0,0,0,0,-4372.75820000000,10931.8955000000,0,0,0,0,0,0,0,0,0;0,0,0,-46399.3700000000,0,60415.8464000000,46399.3700000000,10931.8955000000,161796.195800000,0,0,0,0,0,0,0,-10931.8955000000,18044.9155000000,0,0,0,0,0,0,0,0,0;-696361.745100000,0,0,0,0,0,0,0,0,1439122.86020000,0,0,-23199.6850000000,0,-46399.3700000000,0,0,0,-696361.745100000,0,0,0,0,0,0,0,0;0,-4372.75820000000,-10931.8955000000,0,0,0,0,0,0,0,3117503.30690000,0,0,-1554378.89530000,0,0,0,0,0,-4372.75820000000,10931.8955000000,0,0,0,0,0,0;0,10931.8955000000,18044.9155000000,0,0,0,0,0,0,0,0,323592.391500000,46399.3700000000,0,60415.8464000000,0,0,0,0,-10931.8955000000,18044.9155000000,0,0,0,0,0,0;0,0,0,-696361.745100000,0,0,0,0,0,-23199.6850000000,0,46399.3700000000,1439122.86020000,0,0,-23199.6850000000,0,-46399.3700000000,0,0,0,-696361.745100000,0,0,0,0,0;0,0,0,0,-4372.75820000000,-10931.8955000000,0,0,0,0,-1554378.89530000,0,0,3117503.30690000,0,0,-1554378.89530000,0,0,0,0,0,-4372.75820000000,10931.8955000000,0,0,0;0,0,0,0,10931.8955000000,18044.9155000000,0,0,0,-46399.3700000000,0,60415.8464000000,0,0,323592.391500000,46399.3700000000,0,60415.8464000000,0,0,0,0,-10931.8955000000,18044.9155000000,0,0,0;0,0,0,0,0,0,-696361.745100000,0,0,0,0,0,-23199.6850000000,0,46399.3700000000,1415923.17510000,0,46399.3700000000,0,0,0,0,0,0,-696361.745100000,0,0;0,0,0,0,0,0,0,-4372.75820000000,-10931.8955000000,0,0,0,0,-1554378.89530000,0,0,1563124.41170000,0,0,0,0,0,0,0,0,-4372.75820000000,10931.8955000000;0,0,0,0,0,0,0,10931.8955000000,18044.9155000000,0,0,0,-46399.3700000000,0,60415.8464000000,46399.3700000000,0,198410.757800000,0,0,0,0,0,0,0,-10931.8955000000,18044.9155000000;0,0,0,0,0,0,0,0,0,-696361.745100000,0,0,0,0,0,0,0,0,742761.115100000,0,0,-23199.6850000000,0,-46399.3700000000,0,0,0;0,0,0,0,0,0,0,0,0,0,-4372.75820000000,-10931.8955000000,0,0,0,0,0,0,0,3113130.54870000,-10931.8955000000,0,-1554378.89530000,0,0,0,0;0,0,0,0,0,0,0,0,0,0,10931.8955000000,18044.9155000000,0,0,0,0,0,0,0,-10931.8955000000,286977.829400000,46399.3700000000,0,60415.8464000000,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,-696361.745100000,0,0,0,0,0,-23199.6850000000,0,46399.3700000000,742761.115100000,0,0,-23199.6850000000,0,-46399.3700000000;0,0,0,0,0,0,0,0,0,0,0,0,0,-4372.75820000000,-10931.8955000000,0,0,0,0,-1554378.89530000,0,0,3113130.54870000,-10931.8955000000,0,-1554378.89530000,0;0,0,0,0,0,0,0,0,0,0,0,0,0,10931.8955000000,18044.9155000000,0,0,0,-46399.3700000000,0,60415.8464000000,0,-10931.8955000000,286977.829400000,46399.3700000000,0,60415.8464000000;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-696361.745100000,0,0,0,0,0,-23199.6850000000,0,46399.3700000000,719561.430100000,0,46399.3700000000;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-4372.75820000000,-10931.8955000000,0,0,0,0,-1554378.89530000,0,0,1558751.65350000,-10931.8955000000;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,10931.8955000000,18044.9155000000,0,0,0,-46399.3700000000,0,60415.8464000000,46399.3700000000,-10931.8955000000,161796.195800000];
%m=mmodal*1000/9.806;% matriz de masa timo  shenko
%m=mmodalc*1000/9.806; % matriz de masa cocentrada
%k=kmodal*1000;
%m=m;
sizem=size(m,1);
if GL==6
    val=zeros(sizem,3);
    recorrido1=1:6:sizem;
    valones=ones(sizem/6,1);
    val(recorrido1(1,:),1)=valones;
    val(recorrido1(1,:)+1,2)=valones;
    val(recorrido1(1,:)+2,3)=valones;
    val(recorrido1(1,:)+3,4)=valones;
    val(recorrido1(1,:)+4,5)=valones;
    val(recorrido1(1,:)+5,6)=valones;
elseif GL==3
    val=zeros(sizem,2);
    recorrido1=1:3:sizem;
    valones=ones(sizem/3,1);
    val(recorrido1(1,:),1)=valones;
    val(recorrido1(1,:)+1,2)=valones;
    %val(recorrido1(1,:)+2,3)=valones;
elseif GL==2
    val=zeros(sizem,2);
    recorrido1=1:3:sizem(1,1);
    valones=ones(sizem(1,1)/2,1);
    val(recorrido1(1,:),1)=valones;
    val(recorrido1(1,:)+1,2)=valones;
elseif GL==1
    val=ones(sizem(1,1),1); 
end
%OPT.maxit = 10000;
%OPT.tol   = 1e-32;
%OPT.issym = 1;  % La matriz Kdd es simetrica
%[Phi,Omega2,flag] = eigs(k,m,n,'SM',OPT);% autovalores y autovectores
iter=40;
[Phi,Omega,Tw]=estodola(k,m,iter,n);

%if flag ~= 0
%   warning('El calculo de valores y vectores propios no convergio');
%end
%Omega = sqrt(diag(Omega2));  % frecuencias angulares
%[Omega,I] = sort(Omega);     % ordena las frecuencias
Te = 2*pi./Omega;             % seg - periodo de vibracion 
%Phi = Phi(:,I); % ordena los modos segun el orden de las frecuencias
%Phi = Phi./repmat(sqrt(diag(Phi'*m*Phi)'),size(Phi,1),1); % normaliza los modos
phim=(Phi'*m)';%*ones(sizem(1,1),1);
%vaL=[1;0;0;1;0;0;1;0;0;1;0;0;1;0;0;1;0;0;1;0;0;1;0;0;1;0;0;1;0;0];
%val=[1,0,0;0,1,0;0,0,1;1,0,0;0,1,0;0,0,1;1,0,0;0,1,0;0,0,1;1,0,0;0,1,0;0,0,1;1,0,0;0,1,0;0,0,1;1,0,0;0,1,0;0,0,1;1,0,0;0,1,0;0,0,1;1,0,0;0,1,0;0,0,1;1,0,0;0,1,0;0,0,1;1,0,0;0,1,0;0,0,1];
Aa=0.15;
Av=0.2;
I=1;
suelo=5;
sa=espectro(Aa,Av,I,suelo,Te);
def=sa*9.8067./(Omega).^2;
%Phis=sum(m*Phi);
%p=m*Phi./Phis;

meff=(Phi'*m*val).^2;

alfa=((Phi'*m*val).*def);%coeficiente de participación 


eta1=Phi*diag(alfa(:,1));

eta2=Phi*diag(alfa(:,2));
sm=meff./sum(meff);%% participacíon modal

sizexy=size(xyc,1);
fuer=zeros(sizexy*GL,1);

Ugtt=zeros(sizexy(1,1)*GL,n);
Fgtt=zeros(sizexy(1,1)*GL,n);
def=zeros(sizem,1);
for i=1:sizem
    def(i,1)=rssq(eta1(i,:));
    %fuer(i,1)=rssq(d(i,:));
end
%valalfa=val*alfa'*r;
%Umod1=zeros(sizem(1,1),n);
%Fmod=zeros(sizem(1,1),n);
%for i=1:n
%    Umod1(:,i)=Phi(:,i).*valalfa(:,i);
%    Fmod(:,i)=k*Phi(:,i).*valalfa(:,i);
%    %Umod=Phi*diag(alfa.*sa*9.806./(2*pi./T).^2);
%    %F1=k*Phi*diag(alfa.*sa*9.806./(2*pi./T).^2);
%end

Phia=zeros(sizexy(1,1)*GL,n);
kgttm=zeros(sizexy(1,1)*GL,n);
%Ugtt(d,:)=Umod1;% desplazamietos modales
%Fgtt(d,:)=Fmod;% desplazamietos modales
%kgttm(d,d)=k;% desplazamietos modales
%Fb=(kgttm)*Ugtt; %fuerzas sismicas
%Phia(d,:)=Phi;

%% Momentos nodale equivalentes

def1=zeros(sizexy(1,1)*GL,n);
def1(d,1:n)=eta1;
qe_glob = cell(elementos(1,1),1);
qe_loc  = cell(elementos(1,1),1);
Ce = cell(elementos,1); 

for e=1:elementos(1,1)   % para cada barra
    qe_glob{e} = T{e}*(Ke{e}*def1(GLe(e,:),:));
    qe_loc{e}=T{e}*qe_glob{e};
    x1 = xye(e,1);  x2 = xye(e,3);
    y1 = xye(e,2);  y2 = xye(e,4);
    Ce{e}=[0;0;0;0;0;0];
    deformada_combinacion_modal(AEe(e),EIe(e),Ace(e),Ce(e,:),T{e}*def1(GLe(e,:),:),Le(e),ang(e),kw(e),P(e),lalb(e,:),esc_def,esc_faxial,esc_V,esc_M,x1,y1,x2,y2,tipo_conti(e,:),iteraciones,ite,puntos_graficas,n)
end


figure(2); hold on; title('Deformada exagerada');    xlabel('x, m'); ylabel('y, m'); axis equal
figure(3); hold on; title('Fuerza axial [kN]');      xlabel('x, m'); ylabel('y, m'); axis equal
figure(4); hold on; title('Fuerza cortante [kN]');   xlabel('x, m'); ylabel('y, m'); axis equal
figure(5); hold on; title('Momento flector [kN-m]'); xlabel('x, m'); ylabel('y, m'); axis equal


